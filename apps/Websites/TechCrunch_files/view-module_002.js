import*as e from"@wordpress/interactivity";var t={d:(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const r=(e=>{var r={};return t.d(r,e),r})({getElement:()=>e.getElement,store:()=>e.store});(0,r.store)("techcrunch/site-search",{state:{suggestedSearches:[],searchTerm:"",get getSuggestedSearchResults(){const{state:e}=(0,r.store)("techcrunch/site-search");return e.suggestedSearches},get hasSuggestedSearchResults(){const{state:e}=(0,r.store)("techcrunch/site-search"),{suggestedSearches:t,searchTerm:s}=e;return t.length>0&&""!==s}},actions:{queryAutoSearch(e){const{state:t}=(0,r.store)("techcrunch/site-search"),{ref:s}=(0,r.getElement)(),c=function(e,t){let r;return function(...s){const c=this;clearTimeout(r),r=setTimeout((()=>e.apply(c,s)),t)}}((()=>{const e=s.value;if(""===e)return t.suggestedSearches=[],void(t.searchTerm="");t.searchTerm=e,fetch(`/wp-json/tc/v1/suggestedsearch?searchTerm=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error(`The response from the API is not ok: ${e.status}`,`The response text: ${e.statusText}`);return e.json()})).then((e=>{t.suggestedSearches=e.length>0?e:[]})).catch((e=>{console.error("Error fetching autosuggest data:",e)}))}),300);"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&"Tab"!==e.key&&c()},handleSuggestedSearchArrowKeys(e){const{state:t}=(0,r.store)("techcrunch/site-search");if(!t.suggestedSearches&&0===t.suggestedSearches.length)return;const{ref:s}=(0,r.getElement)(),{key:c}=e,n=s.querySelectorAll("a");if(0===n.length)return;const o=Array.from(n).findIndex((e=>e===s.ownerDocument.activeElement));let a;"ArrowDown"===c?(e.preventDefault(),a=o>=0&&o<n.length-1?o+1:0):"ArrowUp"===c&&(a=o>0?o-1:n.length-1),n[a].focus()}},context:{},callbacks:{highlightSearchTerm(){const{state:e}=(0,r.store)("techcrunch/site-search"),{searchTerm:t}=e;if(""===t)return;if(!e.suggestedSearches&&0===e.suggestedSearches.length)return;const{ref:s}=(0,r.getElement)();s.querySelectorAll("a").forEach((e=>{const r=e.textContent.replace(new RegExp(t,"gi"),(e=>`<span class="highlight">${e}</span>`));e.innerHTML=r}))}}});